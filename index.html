<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠØ© - Ø§Ù„ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Cairo', sans-serif;
        }
        
        :root {
            --primary-color: #2a6e3f;
            --secondary-color: #34a853;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --info-color: #3498db;
            --light-bg: #f0f7ff;
            --card-bg: #ffffff;
            --text-color: #333;
            --border-color: #ddd;
        }
        
        body {
            background-color: var(--light-bg);
            color: var(--text-color);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        .header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .header h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        /* ØªÙˆØ¬ÙŠÙ‡Ø§Øª */
        .instructions {
            background: #fff8e1;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-right: 5px solid #f39c12;
        }
        
        .instructions h3 {
            color: #e65100;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .instructions ul {
            padding-right: 25px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .instructions li {
            margin-bottom: 12px;
            line-height: 1.8;
        }
        
        /* ØªØ§Ø±ÙŠØ® Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ */
        .week-dates {
            background: #f0f9ff;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
        }
        
        .date-item {
            text-align: center;
            padding: 15px 25px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            min-width: 200px;
        }
        
        .date-label {
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 8px;
            font-size: 1.1rem;
        }
        
        .date-value {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--secondary-color);
        }
        
        /* Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ */
        .input-form {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }
        
        .form-section {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--light-bg);
        }
        
        .section-title {
            color: var(--primary-color);
            font-size: 1.4rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--primary-color);
            font-size: 1.1rem;
        }
        
        .form-control {
            width: 100%;
            padding: 15px;
            border: 2px solid var(--border-color);
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        .form-control:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(42, 110, 63, 0.1);
        }
        
        select.form-control {
            cursor: pointer;
            background: white;
        }
        
        textarea.form-control {
            resize: vertical;
            min-height: 120px;
        }
        
        /* ÙƒØ±ÙˆØª Ø§Ù„Ø£ÙŠØ§Ù… */
        .day-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            border-right: 5px solid var(--info-color);
            transition: all 0.3s;
        }
        
        .day-card:hover {
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .day-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border-color);
        }
        
        .day-title {
            font-size: 1.4rem;
            color: var(--primary-color);
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .day-date {
            background: var(--info-color);
            color: white;
            padding: 8px 20px;
            border-radius: 25px;
            font-weight: 600;
            font-size: 0.95rem;
        }
        
        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… */
        .control-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 40px;
        }
        
        .btn {
            padding: 18px;
            border-radius: 10px;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            transition: all 0.3s;
            border: none;
            text-align: center;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 15px rgba(42, 110, 63, 0.3);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, var(--info-color) 0%, #2a5298 100%);
            color: white;
        }
        
        .btn-secondary:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 15px rgba(74, 144, 226, 0.3);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, var(--warning-color) 0%, #e67e22 100%);
            color: white;
        }
        
        .btn-warning:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 15px rgba(243, 156, 18, 0.3);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, var(--danger-color) 0%, #c0392b 100%);
            color: white;
        }
        
        .btn-danger:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 15px rgba(231, 76, 60, 0.3);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #1abc9c 0%, #16a085 100%);
            color: white;
        }
        
        .btn-success:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 15px rgba(26, 188, 156, 0.3);
        }
        
        /* Ø±Ø³Ø§Ù„Ø© Ù†Ø·Ø§Ù‚ Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® */
        .dates-message {
            background: #e8f5e9;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
        }
        
        .dates-message i {
            margin-left: 10px;
            color: var(--secondary-color);
        }
        
        /* Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø£Ø³Ø§Ø¨ÙŠØ¹ */
        .week-navigation {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        .week-btn {
            background: white;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
            padding: 12px 25px;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .week-btn:hover {
            background: var(--primary-color);
            color: white;
            transform: translateY(-2px);
        }
        
        /* Ø§Ù„Ø­Ø§Ù„Ø© */
        .status-panel {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            border-right: 5px solid var(--info-color);
        }
        
        .status-item {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .status-icon {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1rem;
        }
        
        .icon-saved { background: var(--primary-color); }
        .icon-loaded { background: var(--info-color); }
        .icon-empty { background: var(--warning-color); }
        
        /* Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ */
        .message {
            padding: 20px;
            border-radius: 10px;
            margin-top: 25px;
            text-align: center;
            font-weight: 600;
            display: none;
        }
        
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        /* Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
            color: var(--primary-color);
        }
        
        .loading i {
            font-size: 3rem;
            margin-bottom: 20px;
        }
        
        .loading p {
            font-size: 1.2rem;
        }
        
        /* Ø§Ù„ÙÙˆØªØ± */
        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 25px;
            color: #666;
            border-top: 1px solid var(--border-color);
            font-size: 0.95rem;
        }
        
        /* Ø§Ù„ØªØ¬Ø§ÙˆØ¨ */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .input-form {
                padding: 20px;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .day-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .control-buttons {
                grid-template-columns: 1fr;
            }
            
            .instructions ul {
                grid-template-columns: 1fr;
            }
            
            .week-navigation {
                flex-direction: column;
                align-items: center;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
            
            .week-dates {
                flex-direction: column;
                align-items: center;
            }
            
            .date-item {
                width: 100%;
                max-width: 300px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
        <div class="header">
            <h1><i class="fas fa-chalkboard-teacher"></i> Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠØ©</h1>
            <p>Ø§Ù„ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ - ÙƒÙ„ Ù…Ø¹Ù„Ù… ÙŠØ¯Ø®Ù„ ÙˆØ§Ø¬Ø¨Ø§Øª Ù…Ø§Ø¯ØªÙ‡ ÙÙ‚Ø·</p>
        </div>
        
        <!-- Ø§Ù„ØªÙˆØ¬ÙŠÙ‡Ø§Øª -->
        <div class="instructions">
            <h3><i class="fas fa-lightbulb"></i> Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø³Ø±ÙŠØ¹</h3>
            <ul>
                <li><strong>Ø§Ù„Ø®Ø·ÙˆØ© 1:</strong> Ø§Ø®ØªØ± Ø§Ù„ØµÙØŒ Ø§Ù„Ø´Ø¹Ø¨Ø©ØŒ ÙˆØ§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ</li>
                <li><strong>Ø§Ù„Ø®Ø·ÙˆØ© 2:</strong> Ø§Ø¶ØºØ· "ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª" Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©</li>
                <li><strong>Ø§Ù„Ø®Ø·ÙˆØ© 3:</strong> Ø£Ø¯Ø®Ù„ ÙˆØ§Ø¬Ø¨Ø§Øª Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ ÙÙŠ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø®ØµØµØ©</li>
                <li><strong>Ø§Ù„Ø®Ø·ÙˆØ© 4:</strong> Ø§Ø³ØªØ®Ø¯Ù… "Ø­ÙØ¸" Ù„ÙˆØ§Ø¬Ø¨Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© Ø£Ùˆ "ØªØ¹Ø¯ÙŠÙ„" Ù„Ù„ØªØ­Ø¯ÙŠØ«</li>
                <li><strong>Ù…Ù„Ø§Ø­Ø¸Ø©:</strong> Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® ØªØ­ÙØ¸ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø­Ø³Ø¨ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø­Ø§Ù„ÙŠ</li>
            </ul>
        </div>
        
        <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ø­Ø§Ù„Ø© -->
        <div class="status-panel" id="statusPanel" style="display: none;">
            <h3 class="section-title"><i class="fas fa-info-circle"></i> Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù…</h3>
            <div id="statusContent"></div>
        </div>
        
        <!-- Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ -->
        <div class="input-form">
            <div class="form-section">
                <h2 class="section-title"><i class="fas fa-cog"></i> Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</h2>
                
                <div class="form-row">
                    <!-- Ø§Ù„ØµÙ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ -->
                    <div class="form-group">
                        <label for="grade"><i class="fas fa-graduation-cap"></i> Ø§Ù„ØµÙ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</label>
                        <select id="grade" class="form-control" required>
                            <option value="">Ø§Ø®ØªØ± Ø§Ù„ØµÙ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</option>
                            <option value="Ø§Ù„Ø£ÙˆÙ„">Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„</option>
                            <option value="Ø§Ù„Ø«Ø§Ù†ÙŠ">Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ</option>
                            <option value="Ø§Ù„Ø«Ø§Ù„Ø«">Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø«</option>
                            <option value="Ø§Ù„Ø±Ø§Ø¨Ø¹">Ø§Ù„ØµÙ Ø§Ù„Ø±Ø§Ø¨Ø¹</option>
                            <option value="Ø§Ù„Ø®Ø§Ù…Ø³">Ø§Ù„ØµÙ Ø§Ù„Ø®Ø§Ù…Ø³</option>
                            <option value="Ø§Ù„Ø³Ø§Ø¯Ø³">Ø§Ù„ØµÙ Ø§Ù„Ø³Ø§Ø¯Ø³</option>
                            <option value="Ø§Ù„Ø³Ø§Ø¨Ø¹">Ø§Ù„ØµÙ Ø§Ù„Ø³Ø§Ø¨Ø¹</option>
                            <option value="Ø§Ù„Ø«Ø§Ù…Ù†">Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù…Ù†</option>
                            <option value="Ø§Ù„ØªØ§Ø³Ø¹">Ø§Ù„ØµÙ Ø§Ù„ØªØ§Ø³Ø¹</option>
                        </select>
                    </div>
                    
                    <!-- Ø§Ù„Ø´Ø¹Ø¨Ø© -->
                    <div class="form-group">
                        <label for="class"><i class="fas fa-users"></i> Ø§Ù„Ø´Ø¹Ø¨Ø©</label>
                        <select id="class" class="form-control" required>
                            <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø´Ø¹Ø¨Ø©</option>
                            <option value="Ø£">Ø§Ù„Ø´Ø¹Ø¨Ø© Ø£</option>
                            <option value="Ø¨">Ø§Ù„Ø´Ø¹Ø¨Ø© Ø¨</option>
                            <option value="Ø¬">Ø§Ù„Ø´Ø¹Ø¨Ø© Ø¬</option>
                            <option value="Ø¯">Ø§Ù„Ø´Ø¹Ø¨Ø© Ø¯</option>
                        </select>
                    </div>
                    
                    <!-- Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ© -->
                    <div class="form-group">
                        <label for="subject"><i class="fas fa-book"></i> Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</label>
                        <select id="subject" class="form-control" required>
                            <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</option>
                            <option value="Ù‚Ø±Ø¢Ù†">Ù‚Ø±Ø¢Ù†</option>
                            <option value="Ø¥Ø³Ù„Ø§Ù…ÙŠØ©">Ø¥Ø³Ù„Ø§Ù…ÙŠØ©</option>
                            <option value="Ù„ØºØ© Ø¹Ø±Ø¨ÙŠØ©">Ù„ØºØ© Ø¹Ø±Ø¨ÙŠØ©</option>
                            <option value="Ù„ØºØ© Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©">Ù„ØºØ© Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</option>
                            <option value="Ø±ÙŠØ§Ø¶ÙŠØ§Øª">Ø±ÙŠØ§Ø¶ÙŠØ§Øª</option>
                            <option value="Ø¹Ù„ÙˆÙ…">Ø¹Ù„ÙˆÙ…</option>
                            <option value="Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ§Øª">Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ§Øª</option>
                        </select>
                    </div>
                </div>
                
                <!-- Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù… -->
                <div class="form-group" style="max-width: 400px;">
                    <label for="teacher"><i class="fas fa-user"></i> Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                    <input type="text" id="teacher" class="form-control" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ù„Ù„Ù…Ø±Ø¬Ø¹ÙŠØ©">
                </div>
                
                <!-- ØªØ§Ø±ÙŠØ® Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ -->
                <div class="week-dates" id="weekDates">
                    <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª -->
                </div>
                
                <!-- Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø£Ø³Ø§Ø¨ÙŠØ¹ -->
                <div class="week-navigation">
                    <button class="week-btn" onclick="navigateWeek(-1)">
                        <i class="fas fa-chevron-right"></i> Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø³Ø§Ø¨Ù‚
                    </button>
                    <button class="week-btn" onclick="loadCurrentWeek()">
                        <i class="fas fa-sync"></i> ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø­Ø§Ù„ÙŠ
                    </button>
                    <button class="week-btn" onclick="navigateWeek(1)">
                        Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„ØªØ§Ù„ÙŠ <i class="fas fa-chevron-left"></i>
                    </button>
                </div>
            </div>
            
            <!-- ÙˆØ§Ø¬Ø¨Ø§Øª Ø§Ù„Ø£ÙŠØ§Ù… -->
            <div class="form-section">
                <h2 class="section-title"><i class="fas fa-tasks"></i> ÙˆØ§Ø¬Ø¨Ø§Øª Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</h2>
                <div id="daysContainer">
                    <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª -->
                </div>
            </div>
            
            <!-- Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
            <div class="loading" id="formLoading">
                <i class="fas fa-spinner fa-spin"></i>
                <p>Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</p>
            </div>
            
            <!-- Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ -->
            <div id="message" class="message"></div>
            
            <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… -->
            <div class="control-buttons">
                <button class="btn btn-secondary" onclick="loadHomework()">
                    <i class="fas fa-search"></i> ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª
                </button>
                
                <button class="btn btn-success" onclick="saveHomework()">
                    <i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª
                </button>
                
                <button class="btn btn-warning" onclick="updateHomework()">
                    <i class="fas fa-edit"></i> ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª
                </button>
                
                <button class="btn btn-danger" onclick="deleteHomework()">
                    <i class="fas fa-trash-alt"></i> Ø­Ø°Ù Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª
                </button>
                
                <button class="btn btn-primary" onclick="clearForm()">
                    <i class="fas fa-broom"></i> ØªÙØ±ÙŠØº Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                </button>
            </div>
        </div>
        
        <!-- Ø§Ù„ÙÙˆØªØ± -->
        <div class="footer">
            <p>Ù†Ø¸Ø§Ù… Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠØ© &copy; 2023 | Ø¥ØµØ¯Ø§Ø± 3.0 - Ø§Ù„ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ</p>
            <p style="font-size: 0.9rem; margin-top: 10px; color: #888;">
                ØªÙ… Ø±Ø¨Ø· Ø§Ù„Ù†Ø¸Ø§Ù… Ù…Ø¹ Google Sheets | ÙƒÙ„ Ù…Ø¹Ù„Ù… ÙŠØ¯Ø®Ù„ ÙˆØ§Ø¬Ø¨Ø§Øª Ù…Ø§Ø¯ØªÙ‡ ÙÙ‚Ø·
            </p>
        </div>
    </div>
    
    <!-- Ø§Ù„Ø³ÙƒØ±Ø¨Øª -->
    <script>
       // ============ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ============
const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbx553BXYZfRZyEpKjXXyuMXkaTOr3hhk80bx4zlWYh2atrXABPvE6nDvvJ0XUeiH90-/exec';

let currentWeekStart = null;
let currentWeekEnd = null;

const daysOfWeek = [
    { id: 'Ø§Ù„Ø³Ø¨Øª', icon: 'fas fa-calendar-day', color: '#3498db' },
    { id: 'Ø§Ù„Ø£Ø­Ø¯', icon: 'fas fa-sun', color: '#f39c12' },
    { id: 'Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†', icon: 'fas fa-moon', color: '#9b59b6' },
    { id: 'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡', icon: 'fas fa-star', color: '#e74c3c' },
    { id: 'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡', icon: 'fas fa-cloud', color: '#1abc9c' }
];

// ============ Ø§Ù„ØªÙ‡ÙŠØ¦Ø© ============
document.addEventListener('DOMContentLoaded', function() {
    console.log('ğŸš€ Ø¨Ø¯Ø¡ Ù†Ø¸Ø§Ù… Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª Ù…Ø¹ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¬Ø¯ÙŠØ¯');
    console.log('ğŸ”— Ø±Ø§Ø¨Ø· Apps Script:', APPS_SCRIPT_URL);
    
    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹
    calculateCurrentWeek();
    renderWeekDates();
    renderDays();
    updateStatus();
    
    // Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø¹Ø¯ ØªØ£Ø®ÙŠØ±
    setTimeout(() => {
        testConnection();
        autoLoadIfComplete();
    }, 1000);
    
    // Ù…Ø³ØªÙ…Ø¹Ø§Øª Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
    setupEventListeners();
});

// ============ Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ§Ø±ÙŠØ® ============
function calculateCurrentWeek() {
    const today = new Date();
    const dayOfWeek = today.getDay();
    const daysSinceSaturday = (dayOfWeek + 1) % 7;
    const lastSaturday = new Date(today);
    lastSaturday.setDate(today.getDate() - daysSinceSaturday);
    
    currentWeekStart = new Date(lastSaturday);
    currentWeekEnd = new Date(lastSaturday);
    currentWeekEnd.setDate(lastSaturday.getDate() + 4);
}

function formatDate(date) {
    const day = date.getDate().toString().padStart(2, '0');
    const month = (date.getMonth() + 1).toString().padStart(2, '0');
    const year = date.getFullYear();
    return `${day}/${month}/${year}`;
}

function formatDateDisplay(date) {
    return date.toLocaleDateString('ar-EG', {
        weekday: 'long',
        year: 'numeric',
        month: 'long',
        day: 'numeric'
    });
}

// ============ Ø§Ù„Ø¹Ø±Ø¶ ============
function renderWeekDates() {
    if (!currentWeekStart || !currentWeekEnd) return;
    
    const container = document.getElementById('weekDates');
    container.innerHTML = `
        <div class="date-item">
            <div class="date-label">Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ (Ø§Ù„Ø³Ø¨Øª)</div>
            <div class="date-value">${formatDate(currentWeekStart)}</div>
        </div>
        <div class="date-item">
            <div class="date-label">Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ (Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡)</div>
            <div class="date-value">${formatDate(currentWeekEnd)}</div>
        </div>
    `;
}

function renderDays() {
    if (!currentWeekStart) return;
    
    const container = document.getElementById('daysContainer');
    let html = '';
    
    for (let i = 0; i < 5; i++) {
        const day = daysOfWeek[i];
        const currentDate = new Date(currentWeekStart);
        currentDate.setDate(currentWeekStart.getDate() + i);
        
        html += `
            <div class="day-card">
                <div class="day-header">
                    <div class="day-title">
                        <i class="${day.icon}" style="color: ${day.color}"></i>
                        ${day.id}
                    </div>
                    <div class="day-date">${formatDateDisplay(currentDate)}</div>
                </div>
                <div class="form-group">
                    <label for="homework_${day.id}"><i class="fas fa-tasks"></i> Ø§Ù„ÙˆØ§Ø¬Ø¨</label>
                    <textarea 
                        id="homework_${day.id}" 
                        class="form-control" 
                        rows="4" 
                        placeholder="Ø£Ø¯Ø®Ù„ ÙˆØ§Ø¬Ø¨ ${day.id} Ù‡Ù†Ø§..."
                    ></textarea>
                </div>
            </div>
        `;
    }
    
    container.innerHTML = html;
}

// ============ Ø§Ù„Ø§ØªØµØ§Ù„ Ù…Ø¹ Apps Script ============
async function callAppScript(action, data = null, method = 'GET') {
    console.log(`ğŸ“¤ ${method} ${action}`, data || '');
    showLoading(true);
    
    try {
        let url = APPS_SCRIPT_URL;
        const options = {
            method: method,
            headers: { 'Content-Type': 'application/json' }
        };
        
        if (method === 'GET' && data) {
            const params = new URLSearchParams({ action, ...data });
            url += '?' + params.toString();
        } else if (method === 'POST' && data) {
            options.body = JSON.stringify({ ...data, action });
        } else {
            url += '?action=' + action;
        }
        
        console.log('ğŸ”— Ø§Ù„Ø·Ù„Ø¨ Ø¥Ù„Ù‰:', url);
        const response = await fetch(url, options);
        
        if (!response.ok) {
            throw new Error(`Ø®Ø·Ø£ ${response.status}: ${response.statusText}`);
        }
        
        const result = await response.json();
        console.log('âœ… Ø§Ù„Ù†ØªÙŠØ¬Ø©:', result);
        
        showLoading(false);
        return result;
        
    } catch (error) {
        console.error('âŒ Ø®Ø·Ø£:', error);
        showLoading(false);
        showMessage(`âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„: ${error.message}`, 'error');
        return { error: error.message };
    }
}

// ============ Ø¯ÙˆØ§Ù„ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ============
async function loadHomework() {
    const grade = document.getElementById('grade').value;
    const className = document.getElementById('class').value;
    const subject = document.getElementById('subject').value;
    
    if (!grade || !className || !subject) {
        showMessage('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØµÙ ÙˆØ§Ù„Ø´Ø¹Ø¨Ø© ÙˆØ§Ù„Ù…Ø§Ø¯Ø© Ø£ÙˆÙ„Ø§Ù‹', 'error');
        return;
    }
    
    const data = {
        grade,
        class: className,
        subject,
        startDate: formatDate(currentWeekStart),
        endDate: formatDate(currentWeekEnd)
    };
    
    const result = await callAppScript('getHomework', data, 'GET');
    
    if (result.error) {
        showMessage('Ø®Ø·Ø£: ' + result.error, 'error');
        return;
    }
    
    if (result.exists) {
        daysOfWeek.forEach(day => {
            const textarea = document.getElementById(`homework_${day.id}`);
            if (textarea) {
                const dayKey = day.id.toLowerCase();
                textarea.value = result.homework[dayKey] || '';
            }
        });
        showMessage('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
    } else {
        showMessage('ğŸ“ Ù„Ø§ ØªÙˆØ¬Ø¯ ÙˆØ§Ø¬Ø¨Ø§Øª Ù…Ø³Ø¬Ù„Ø©ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¯Ø®Ø§Ù„ ÙˆØ§Ø¬Ø¨Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©', 'info');
        clearHomeworkFields();
    }
    
    updateStatus();
}

async function saveHomework() {
    const homeworkData = collectHomeworkData();
    if (!homeworkData) return;
    
    const result = await callAppScript('saveHomework', homeworkData, 'POST');
    
    if (result.success) {
        const time = result.timestamp || new Date().toLocaleTimeString('ar-EG');
        showMessage(`âœ… ${result.message} (${time})`, 'success');
        updateStatus();
        
        // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„ØªØ§Ø¦ÙŠ Ø¨Ø¹Ø¯ Ø§Ù„Ø­ÙØ¸
        setTimeout(() => navigateWeek(1), 1500);
    } else {
        showMessage(result.error || 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ÙØ¸', 'error');
    }
}

async function updateHomework() {
    const homeworkData = collectHomeworkData();
    if (!homeworkData) return;
    
    const result = await callAppScript('updateHomework', homeworkData, 'POST');
    
    if (result.success) {
        const time = result.timestamp || new Date().toLocaleTimeString('ar-EG');
        showMessage(`âœï¸ ${result.message} (${time})`, 'success');
        updateStatus();
    } else {
        showMessage(result.error || 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„', 'error');
    }
}

async function deleteHomework() {
    const grade = document.getElementById('grade').value;
    const className = document.getElementById('class').value;
    const subject = document.getElementById('subject').value;
    
    if (!grade || !className || !subject) {
        showMessage('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØµÙ ÙˆØ§Ù„Ø´Ø¹Ø¨Ø© ÙˆØ§Ù„Ù…Ø§Ø¯Ø© Ø£ÙˆÙ„Ø§Ù‹', 'error');
        return;
    }
    
    if (!confirm('âš ï¸ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù ÙˆØ§Ø¬Ø¨Ø§Øª Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ØŸ\n\nÙ‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡.')) {
        return;
    }
    
    const data = {
        grade,
        class: className,
        subject,
        startDate: formatDate(currentWeekStart),
        endDate: formatDate(currentWeekEnd)
    };
    
    const result = await callAppScript('deleteHomework', data, 'POST');
    
    if (result.success) {
        showMessage('ğŸ—‘ï¸ ' + result.message, 'success');
        clearHomeworkFields();
        updateStatus();
    } else {
        showMessage(result.error || 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­Ø°Ù', 'error');
    }
}

// ============ Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© ============
function collectHomeworkData() {
    const grade = document.getElementById('grade').value;
    const className = document.getElementById('class').value;
    const subject = document.getElementById('subject').value;
    const teacher = document.getElementById('teacher').value;
    
    if (!grade || !className || !subject) {
        showMessage('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØµÙ ÙˆØ§Ù„Ø´Ø¹Ø¨Ø© ÙˆØ§Ù„Ù…Ø§Ø¯Ø© Ø£ÙˆÙ„Ø§Ù‹', 'error');
        return null;
    }
    
    const data = {
        grade,
        class: className,
        subject,
        saturday: document.getElementById('homework_Ø§Ù„Ø³Ø¨Øª')?.value || '',
        sunday: document.getElementById('homework_Ø§Ù„Ø£Ø­Ø¯')?.value || '',
        monday: document.getElementById('homework_Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†')?.value || '',
        tuesday: document.getElementById('homework_Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡')?.value || '',
        wednesday: document.getElementById('homework_Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡')?.value || '',
        startDate: formatDate(currentWeekStart),
        endDate: formatDate(currentWeekEnd)
    };
    
    if (teacher) {
        data.teacher = teacher;
    }
    
    return data;
}

function clearHomeworkFields() {
    daysOfWeek.forEach(day => {
        const textarea = document.getElementById(`homework_${day.id}`);
        if (textarea) textarea.value = '';
    });
}

function updateStatus() {
    const grade = document.getElementById('grade').value;
    const className = document.getElementById('class').value;
    const subject = document.getElementById('subject').value;
    
    if (!grade || !className || !subject) {
        document.getElementById('statusPanel').style.display = 'none';
        return;
    }
    
    let homeworkCount = 0;
    daysOfWeek.forEach(day => {
        const textarea = document.getElementById(`homework_${day.id}`);
        if (textarea && textarea.value.trim()) homeworkCount++;
    });
    
    const statusHTML = `
        <div class="status-item">
            <div class="status-icon icon-loaded">
                <i class="fas fa-calendar-week"></i>
            </div>
            <div><strong>Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹:</strong> ${formatDate(currentWeekStart)} â†’ ${formatDate(currentWeekEnd)}</div>
        </div>
        <div class="status-item">
            <div class="status-icon icon-saved">
                <i class="fas fa-graduation-cap"></i>
            </div>
            <div><strong>Ø§Ù„ØµÙ:</strong> ${grade} | <strong>Ø§Ù„Ø´Ø¹Ø¨Ø©:</strong> ${className} | <strong>Ø§Ù„Ù…Ø§Ø¯Ø©:</strong> ${subject}</div>
        </div>
        <div class="status-item">
            <div class="status-icon ${homeworkCount > 0 ? 'icon-saved' : 'icon-empty'}">
                <i class="fas fa-tasks"></i>
            </div>
            <div><strong>Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª Ø§Ù„Ù…Ø¯Ø®Ù„Ø©:</strong> ${homeworkCount} Ù…Ù† 5 Ø£ÙŠØ§Ù…</div>
        </div>
    `;
    
    document.getElementById('statusContent').innerHTML = statusHTML;
    document.getElementById('statusPanel').style.display = 'block';
}

// ============ Ø§Ù„ØªÙ†Ù‚Ù„ ÙˆØ§Ù„ØªØ­ÙƒÙ… ============
function navigateWeek(direction) {
    if (!currentWeekStart || !currentWeekEnd) return;
    
    currentWeekStart.setDate(currentWeekStart.getDate() + (direction * 7));
    currentWeekEnd.setDate(currentWeekEnd.getDate() + (direction * 7));
    
    renderWeekDates();
    renderDays();
    
    const grade = document.getElementById('grade').value;
    const className = document.getElementById('class').value;
    const subject = document.getElementById('subject').value;
    
    if (grade && className && subject) {
        setTimeout(loadHomework, 300);
    } else {
        clearHomeworkFields();
    }
    
    showMessage(`ğŸ“… ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ù„Ù„Ø£Ø³Ø¨ÙˆØ¹: ${formatDate(currentWeekStart)} - ${formatDate(currentWeekEnd)}`, 'info');
}

function loadCurrentWeek() {
    calculateCurrentWeek();
    renderWeekDates();
    renderDays();
    
    const grade = document.getElementById('grade').value;
    const className = document.getElementById('class').value;
    const subject = document.getElementById('subject').value;
    
    if (grade && className && subject) {
        setTimeout(loadHomework, 300);
    } else {
        clearHomeworkFields();
    }
    
    showMessage('ğŸ”„ ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø­Ø§Ù„ÙŠ', 'info');
}

function clearForm() {
    document.getElementById('grade').value = '';
    document.getElementById('class').value = '';
    document.getElementById('subject').value = '';
    document.getElementById('teacher').value = '';
    
    clearHomeworkFields();
    updateStatus();
    
    showMessage('ğŸ§¹ ØªÙ… ØªÙØ±ÙŠØº Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¨Ø¯Ø¡ Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ø¯ÙŠØ¯', 'info');
}

// ============ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙˆØ§Ù„ØªØµØ­ÙŠØ­ ============
async function testConnection() {
    console.log('ğŸ”§ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ù…Ø¹ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø¬Ø¯ÙŠØ¯...');
    
    const result = await callAppScript('test', null, 'GET');
    
    if (result && result.success) {
        console.log('âœ… Ø§Ø®ØªØ¨Ø§Ø± Ù†Ø§Ø¬Ø­:', result);
        showMessage(`âœ… ${result.message || 'Ø§Ù„Ø§ØªØµØ§Ù„ ÙŠØ¹Ù…Ù„!'} (Ø§Ù„Ø¥ØµØ¯Ø§Ø±: ${result.version || '1.0'})`, 'success');
        return true;
    } else {
        console.error('âŒ Ø§Ø®ØªØ¨Ø§Ø± ÙØ§Ø´Ù„:', result);
        showMessage('âŒ ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ù…Ø¹ Ø§Ù„Ù†Ø¸Ø§Ù…', 'error');
        return false;
    }
}

function setupEventListeners() {
    document.getElementById('grade').addEventListener('change', updateStatus);
    document.getElementById('class').addEventListener('change', updateStatus);
    document.getElementById('subject').addEventListener('change', updateStatus);
    
    document.getElementById('grade').addEventListener('change', autoLoadIfComplete);
    document.getElementById('class').addEventListener('change', autoLoadIfComplete);
    document.getElementById('subject').addEventListener('change', autoLoadIfComplete);
}

function autoLoadIfComplete() {
    const grade = document.getElementById('grade').value;
    const className = document.getElementById('class').value;
    const subject = document.getElementById('subject').value;
    
    if (grade && className && subject) {
        console.log('ğŸ”„ ØªØ­Ù…ÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠ...');
        setTimeout(loadHomework, 500);
    }
}

// ============ Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ============
function showMessage(text, type) {
    const messageDiv = document.getElementById('message');
    messageDiv.innerHTML = text;
    messageDiv.className = `message ${type}`;
    messageDiv.style.display = 'block';
    
    setTimeout(() => {
        messageDiv.style.display = 'none';
    }, 5000);
}

function showLoading(show) {
    document.getElementById('formLoading').style.display = show ? 'block' : 'none';
}
    </script>
</body>
</html>